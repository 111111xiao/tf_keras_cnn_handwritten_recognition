# 基于卷积神经网络手写体数学公式识别与计算
## 一、项目介绍
- 项目已经可以计算含有PI或e的四则运算公式及指数运算公式。
- 项目可以进行较为简单的一元一次方程或一元二次方程计算。
- 测试网站<http://47.100.51.178:5000/>
- 项目使用tensorflow2.0作为开发框架，采用keras搭建卷积神经网络。
- 数据集采集了mnist及emnist中的数字、字母数据，运算符号为项目组手写制作。
- 图片分割使用了连通域与水平投影共同实现。
- 项目通过flask框架部署在服务器。
- 这是本人参与制作的第一个比课程设计大的项目。仅用来记录自己的代码。
- 同时也欢迎各位大佬指点。
## 二、项目主要代码及功能介绍
### 网络搭建及模型制作
train_model/tf_keras_cnn_mnist_model.ipynb
- 数据量较小采用数据增强
- 重复两层每两次卷积一次池化一次Dropout的操作，最后softmax全连接
- 由于租借用的训练服务器到期，故没有训练好的IPython代码
- 训练后模型保存为keras.h5
### 图像分割及识别
module/concom.py
- 通过多链表实现的连通域 --制作此处时作者水平有限，可优化
- make_img()负责将图片转换为带空白边框的正方形图片利于识别
- preprocessing_and_predict_image()负责识别图片并预测
- merge_by_vertial()图片被分割后合并在垂直方向上重合的图片
- is_subset() 判断部分图片是否为另一部分图片的子图片
- is_index() 判断这部分图片的位置决定是否是幂
- find_small_image() 寻找到噪点图片

- connected_components() 通过连通域获取图片列表
- List.preprocess() 图片链表预处理，删除噪点图片及最后的空节点处理图片列表
- make_image_list() 处理图片列表，合并被拆散的垂直图片以及子图片，使图片链表可以被识别

- get_h_projection() 对图片进行水平投影
- preprocessing_and_predict_image() 识别当前图片节点的结果
- predict_division() 递归调用水平投影与识别函数，识别出分号除号等号...这类跨行符号
### 根据结果计算
module/calcul.py
这部分并非我设计，所以不给出代码分析
### 图像获取及结果输出
one_calculate/app.py
- 图片通过前端上传base64编码数据
- convertImage()负责解码及保存图片
- convertImage2()及以下内容为数据集绘制网页路由，不用在意
- predict_fun() 用于图像二值化及识别的函数，根据falg决定输出格式
- 最后返回的字符串为LaTex格式
## 三、最后
这是本人的第一个除了课设以外的项目，现在距离开发结束时隔十个月了，拖了这么久发出来主要是因为本来想继续新增内容后再发出来。但是途中本人发生了意外后项目一直处于停滞不前的状态。
时间过去太久了，又有很多新的事情要忙，因此暂定项目就做到这了，所以于今天发布。我深知当时自己的技术力还很弱，如果有人看到这里的话希望你您可以接受我的作品指出您的看法，我会虚心学习的。
